<span title="LineNr "class="LineNr first-LineNr">1</span>  <span title="javaScriptReserved "class="javaScriptReserved">import</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{</span><span title="Normal "class="Normal"> EventDispatcher </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> from </span><span title="javaScriptStringS "class="javaScriptStringS">&#39;./EventDispatcher.js&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">2</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">3</span>  <span title="javaScriptFunction "class="javaScriptFunction">function</span><span title="Normal "class="Normal"> Geometry</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">4</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.uuid &#61; MathUtils.generateUUID</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">5</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.name &#61; </span><span title="javaScriptStringS "class="javaScriptStringS">&#39;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">6</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.type &#61; </span><span title="javaScriptStringS "class="javaScriptStringS">&#39;Geometry&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">7</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">8</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices &#61; </span><span title="javaScriptBraces "class="javaScriptBraces">[]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">9</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs &#61; </span><span title="javaScriptBraces "class="javaScriptBraces">[[]]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">10</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.boundingSphere &#61; </span><span title="javaScriptNull "class="javaScriptNull">null</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">11</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">12</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptLineComment "class="javaScriptLineComment">// update flags
</span><span title="LineNr "class="LineNr">13</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.elementsNeedUpdate &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">false</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">14</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.verticesNeedUpdate &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">false</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">15</span>  <span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">16</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">17</span>  <span title="javaScriptComment "class="javaScriptComment">/**
</span><span title="LineNr "class="LineNr">18</span>  <span title="javaScriptComment "class="javaScriptComment"> * Geometry
</span><span title="LineNr "class="LineNr">19</span>  <span title="javaScriptComment "class="javaScriptComment"> */
</span><span title="LineNr "class="LineNr">20</span>  <span title="Normal "class="Normal">Geometry &#61; </span><span title="javaScriptType "class="javaScriptType">Object</span><span title="Normal "class="Normal">.assign</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptType "class="javaScriptType">Object</span><span title="Normal "class="Normal">.create</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">EventDispatcher.prototype</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">, </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">21</span>  <span title="Normal "class="Normal">  constructor: Geometry,
</span><span title="LineNr "class="LineNr">22</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">23</span>  <span title="Normal "class="Normal">  isGeometry: </span><span title="javaScriptBoolean "class="javaScriptBoolean">true</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">24</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">25</span>  <span title="Normal "class="Normal">  applyMatrix4</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">matrix</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">26</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> normalMatrix &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Matrix3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.getNormalMatrix</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">matrix</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">27</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">28</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, il &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length; i &lt; il; i++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">29</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> face &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">i</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">30</span>  <span title="Normal "class="Normal">      face.normal.applyMatrix3</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">normalMatrix</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">.normalize</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">31</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">32</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> j &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, jl &#61; face.vertexNormals.length; j &lt; jl; j++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">33</span>  <span title="Normal "class="Normal">        face.vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">j</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.applyMatrix3</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">normalMatrix</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">.normalize</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">34</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">35</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">36</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">37</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.verticesNeedUpdate &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">true</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">38</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.normalsNeedUpdate &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">true</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">39</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">40</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">41</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">42</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">43</span>  <span title="Normal "class="Normal">  rotateZ</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">angle</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">44</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptLineComment "class="javaScriptLineComment">// </span><span title="javaScriptCommentTodo "class="javaScriptCommentTodo">TODO</span><span title="javaScriptLineComment "class="javaScriptLineComment">: Verify edge case
</span><span title="LineNr "class="LineNr">45</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptLineComment "class="javaScriptLineComment">// rotate geometry around world z-axis
</span><span title="LineNr "class="LineNr">46</span>  <span title="Normal "class="Normal">    _m1.makeRotationZ</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">angle</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">47</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.applyMatrix4</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">_m1</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">48</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">49</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">50</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">51</span>  <span title="Normal "class="Normal">  fromBufferGeometry</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">geometry</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">52</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> scope &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">53</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">54</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> index &#61; geometry.index !&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">null</span><span title="Normal "class="Normal"> ? geometry.index : </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">55</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> attributes &#61; geometry.attributes;
</span><span title="LineNr "class="LineNr">56</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">57</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">attributes.position &#61;&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">58</span>  <span title="Normal "class="Normal">      console.error</span><span title="javaScriptParens "class="javaScriptParens">(
</span><span title="LineNr "class="LineNr">59</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptStringS "class="javaScriptStringS">&#39;THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.&#39;</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">60</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">61</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">62</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">63</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">64</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> position &#61; attributes.position;
</span><span title="LineNr "class="LineNr">65</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">uv2 !&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; </span><span title="javaScriptBraces "class="javaScriptBraces">[]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">66</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">67</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">; i &lt; position.count; i++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">68</span>  <span title="Normal "class="Normal">      scope.vertices.push</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.fromBufferAttribute</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">position, i</span><span title="javaScriptParens "class="javaScriptParens">))</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">69</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">70</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">color !&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">71</span>  <span title="Normal "class="Normal">        scope.colors.push</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Color</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.fromBufferAttribute</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">color, i</span><span title="javaScriptParens "class="javaScriptParens">))</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">72</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">73</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">74</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">75</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptFunction "class="javaScriptFunction">function</span><span title="Normal "class="Normal"> addFace</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">a, b, c, materialIndex</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">76</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vertexColors &#61;
</span><span title="LineNr "class="LineNr">77</span>  <span title="Normal "class="Normal">        color &#61;&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined
</span><span title="LineNr "class="LineNr">78</span>  <span title="Normal "class="Normal">          ? </span><span title="javaScriptBraces "class="javaScriptBraces">[]
</span><span title="LineNr "class="LineNr">79</span>  <span title="Normal "class="Normal">          : </span><span title="javaScriptBraces "class="javaScriptBraces">[
</span><span title="LineNr "class="LineNr">80</span>  <span title="Normal "class="Normal">              scope.colors</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">81</span>  <span title="Normal "class="Normal">              scope.colors</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">82</span>  <span title="Normal "class="Normal">              scope.colors</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">83</span>  <span title="Normal "class="Normal">            </span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">84</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">85</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vertexNormals &#61;
</span><span title="LineNr "class="LineNr">86</span>  <span title="Normal "class="Normal">        normal &#61;&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined
</span><span title="LineNr "class="LineNr">87</span>  <span title="Normal "class="Normal">          ? </span><span title="javaScriptBraces "class="javaScriptBraces">[]
</span><span title="LineNr "class="LineNr">88</span>  <span title="Normal "class="Normal">          : </span><span title="javaScriptBraces "class="javaScriptBraces">[
</span><span title="LineNr "class="LineNr">89</span>  <span title="Normal "class="Normal">              </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.fromBufferAttribute</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">normal, a</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">90</span>  <span title="Normal "class="Normal">              </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.fromBufferAttribute</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">normal, b</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">91</span>  <span title="Normal "class="Normal">              </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">.fromBufferAttribute</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">normal, c</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">92</span>  <span title="Normal "class="Normal">            </span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">93</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">94</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> groups &#61; geometry.groups;
</span><span title="LineNr "class="LineNr">95</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">96</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">groups.length &gt; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">97</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">; i &lt; groups.length; i++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">98</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> group &#61; groups</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">i</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">99</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">100</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> start &#61; group.start;
</span><span title="LineNr "class="LineNr">101</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> count &#61; group.count;
</span><span title="LineNr "class="LineNr">102</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">103</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> j &#61; start, jl &#61; start + count; j &lt; jl; j +&#61; </span><span title="javaScriptNumber "class="javaScriptNumber">3</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">104</span>  <span title="Normal "class="Normal">          </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">index !&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">105</span>  <span title="Normal "class="Normal">            addFace</span><span title="javaScriptParens "class="javaScriptParens">(
</span><span title="LineNr "class="LineNr">106</span>  <span title="Normal "class="Normal">              index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">j</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">107</span>  <span title="Normal "class="Normal">              index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">j + </span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">108</span>  <span title="Normal "class="Normal">              index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">j + </span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">109</span>  <span title="Normal "class="Normal">              group.materialIndex,
</span><span title="LineNr "class="LineNr">110</span>  <span title="Normal "class="Normal">            </span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">111</span>  <span title="Normal "class="Normal">          </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> </span><span title="javaScriptConditional "class="javaScriptConditional">else</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">112</span>  <span title="Normal "class="Normal">            addFace</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">j, j + </span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="Normal "class="Normal">, j + </span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="Normal "class="Normal">, group.materialIndex</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">113</span>  <span title="Normal "class="Normal">          </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">114</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">115</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">116</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> </span><span title="javaScriptConditional "class="javaScriptConditional">else</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">117</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">index !&#61;&#61; </span><span title="javaScriptNull "class="javaScriptNull">undefined</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">118</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">; i &lt; index.count; i +&#61; </span><span title="javaScriptNumber "class="javaScriptNumber">3</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">119</span>  <span title="Normal "class="Normal">          addFace</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">i</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">, index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">i + </span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">, index.getX</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">i + </span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="javaScriptParens "class="javaScriptParens">))</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">120</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">121</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> </span><span title="javaScriptConditional "class="javaScriptConditional">else</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">122</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">; i &lt; position.count; i +&#61; </span><span title="javaScriptNumber "class="javaScriptNumber">3</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">123</span>  <span title="Normal "class="Normal">          addFace</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">i, i + </span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="Normal "class="Normal">, i + </span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">124</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">125</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">126</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">127</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">128</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">129</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">130</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">131</span>  <span title="Normal "class="Normal">  center</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">132</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.computeBoundingBox</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">133</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.boundingBox.getCenter</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">_offset</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">.negate</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">134</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.translate</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">_offset.x, _offset.y, _offset.z</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">135</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">136</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">137</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">138</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">139</span>  <span title="Normal "class="Normal">  computeFaceNormals</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">140</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> cb &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">141</span>  <span title="Normal "class="Normal">      ab &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">142</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">143</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> f &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, fl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length; f &lt; fl; f++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">144</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> face &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">f</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">145</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">146</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vA &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">147</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vB &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">148</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vC &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">149</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">150</span>  <span title="Normal "class="Normal">      cb.subVectors</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vC, vB</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">151</span>  <span title="Normal "class="Normal">      ab.subVectors</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vA, vB</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">152</span>  <span title="Normal "class="Normal">      cb.cross</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">ab</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">153</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">154</span>  <span title="Normal "class="Normal">      cb.normalize</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">155</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">156</span>  <span title="Normal "class="Normal">      face.normal.copy</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">cb</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">157</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">158</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">159</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">160</span>  <span title="Normal "class="Normal">  computeVertexNormals</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">areaWeighted &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">true</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">161</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vertices &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> </span><span title="javaScriptType "class="javaScriptType">Array</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices.length</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">162</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">163</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> v &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, vl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices.length; v &lt; vl; v++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">164</span>  <span title="Normal "class="Normal">      vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">v</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">165</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">166</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">167</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">areaWeighted</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">168</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptLineComment "class="javaScriptLineComment">// vertex normals weighted by triangle areas
</span><span title="LineNr "class="LineNr">169</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptLineComment "class="javaScriptLineComment">// http://www.iquilezles.org/www/articles/normals/normals.htm
</span><span title="LineNr "class="LineNr">170</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">171</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> cb &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">172</span>  <span title="Normal "class="Normal">        ab &#61; </span><span title="javaScriptOperator "class="javaScriptOperator">new</span><span title="Normal "class="Normal"> Vector3</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">173</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">174</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> f &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, fl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length; f &lt; fl; f++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">175</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> face &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">f</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">176</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">177</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vA &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">178</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vB &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">179</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vC &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">180</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">181</span>  <span title="Normal "class="Normal">        cb.subVectors</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vC, vB</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">182</span>  <span title="Normal "class="Normal">        ab.subVectors</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vA, vB</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">183</span>  <span title="Normal "class="Normal">        cb.cross</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">ab</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">184</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">185</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">cb</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">186</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">cb</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">187</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">cb</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">188</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">189</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> </span><span title="javaScriptConditional "class="javaScriptConditional">else</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">190</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.computeFaceNormals</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">191</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">192</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> f &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, fl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length; f &lt; fl; f++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">193</span>  <span title="Normal "class="Normal">        </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> face &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">f</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">194</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">195</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">face.normal</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">196</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">face.normal</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">197</span>  <span title="Normal "class="Normal">        vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.add</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">face.normal</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">198</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">199</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">200</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">201</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> v &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, vl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.vertices.length; v &lt; vl; v++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">202</span>  <span title="Normal "class="Normal">      vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">v</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.normalize</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">203</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">204</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">205</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> f &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">, fl &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length; f &lt; fl; f++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">206</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> face &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">f</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">207</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">208</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> vertexNormals &#61; face.vertexNormals;
</span><span title="LineNr "class="LineNr">209</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">210</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vertexNormals.length &#61;&#61;&#61; </span><span title="javaScriptNumber "class="javaScriptNumber">3</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">211</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.copy</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">212</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.copy</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">213</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.copy</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">214</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal"> </span><span title="javaScriptConditional "class="javaScriptConditional">else</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">215</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.a</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">216</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.b</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">217</span>  <span title="Normal "class="Normal">        vertexNormals</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">2</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; vertices</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">face.c</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">.clone</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">218</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">219</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">220</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">221</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces.length &gt; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">222</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.normalsNeedUpdate &#61; </span><span title="javaScriptBoolean "class="javaScriptBoolean">true</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">223</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">224</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">225</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">226</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptComment "class="javaScriptComment">/*
</span><span title="LineNr "class="LineNr">227</span>  <span title="javaScriptComment "class="javaScriptComment">   * Checks for duplicate vertices with hashmap.
</span><span title="LineNr "class="LineNr">228</span>  <span title="javaScriptComment "class="javaScriptComment">   * Duplicated vertices are removed
</span><span title="LineNr "class="LineNr">229</span>  <span title="javaScriptComment "class="javaScriptComment">   * and faces&#39; vertices are updated.
</span><span title="LineNr "class="LineNr">230</span>  <span title="javaScriptComment "class="javaScriptComment">   */
</span><span title="LineNr "class="LineNr">231</span>  <span title="Normal "class="Normal">  sortFacesByMaterialIndex</span><span title="javaScriptParens "class="javaScriptParens">()</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">232</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> faces &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faces;
</span><span title="LineNr "class="LineNr">233</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> length &#61; faces.length;
</span><span title="LineNr "class="LineNr">234</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">235</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptFunction "class="javaScriptFunction">function</span><span title="Normal "class="Normal"> materialIndexSort</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">a, b</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">236</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptStatement "class="javaScriptStatement">return</span><span title="Normal "class="Normal"> a.materialIndex - b.materialIndex;
</span><span title="LineNr "class="LineNr">237</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">238</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">239</span>  <span title="Normal "class="Normal">    faces.sort</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">materialIndexSort</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">240</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">241</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptLineComment "class="javaScriptLineComment">// sort uvs
</span><span title="LineNr "class="LineNr">242</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">243</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> uvs1 &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">244</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> uvs2 &#61; </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">245</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">246</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> newUvs1, newUvs2;
</span><span title="LineNr "class="LineNr">247</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">248</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">uvs1 &amp;&amp; uvs1.length &#61;&#61;&#61; length</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> newUvs1 &#61; </span><span title="javaScriptBraces "class="javaScriptBraces">[]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">249</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">uvs2 &amp;&amp; uvs2.length &#61;&#61;&#61; length</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> newUvs2 &#61; </span><span title="javaScriptBraces "class="javaScriptBraces">[]</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">250</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">251</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptRepeat "class="javaScriptRepeat">for</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="javaScriptIdentifier "class="javaScriptIdentifier">let</span><span title="Normal "class="Normal"> i &#61; </span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="Normal "class="Normal">; i &lt; length; i++</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{
</span><span title="LineNr "class="LineNr">252</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptReserved "class="javaScriptReserved">const</span><span title="Normal "class="Normal"> id &#61; faces</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">i</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal">._id;
</span><span title="LineNr "class="LineNr">253</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">254</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">newUvs1</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> newUvs1.push</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">uvs1</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">id</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">255</span>  <span title="Normal "class="Normal">      </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">newUvs2</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> newUvs2.push</span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">uvs2</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="Normal "class="Normal">id</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">256</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptBraces "class="javaScriptBraces">}
</span><span title="LineNr "class="LineNr">257</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">258</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">newUvs1</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">0</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; newUvs1;
</span><span title="LineNr "class="LineNr">259</span>  <span title="Normal "class="Normal">    </span><span title="javaScriptConditional "class="javaScriptConditional">if</span><span title="Normal "class="Normal"> </span><span title="javaScriptParens "class="javaScriptParens">(</span><span title="Normal "class="Normal">newUvs2</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal"> </span><span title="javaScriptIdentifier "class="javaScriptIdentifier">this</span><span title="Normal "class="Normal">.faceVertexUvs</span><span title="javaScriptBraces "class="javaScriptBraces">[</span><span title="javaScriptNumber "class="javaScriptNumber">1</span><span title="javaScriptBraces "class="javaScriptBraces">]</span><span title="Normal "class="Normal"> &#61; newUvs2;
</span><span title="LineNr "class="LineNr">260</span>  <span title="Normal "class="Normal">  </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">,
</span><span title="LineNr "class="LineNr">261</span>  <span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="javaScriptParens "class="javaScriptParens">)</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">262</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr last-LineNr">263</span>  <span title="javaScriptReserved "class="javaScriptReserved">export</span><span title="Normal "class="Normal"> </span><span title="javaScriptBraces "class="javaScriptBraces">{</span><span title="Normal "class="Normal"> Geometry </span><span title="javaScriptBraces "class="javaScriptBraces">}</span><span title="Normal "class="Normal">;</span>