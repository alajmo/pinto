<span title="LineNr "class="LineNr first-LineNr">1</span>  <span title="luaFunc "class="luaFunc">require</span><span title="Normal "class="Normal"> </span><span title="luaString "class="luaString">&#39;nvim_lsp&#39;
</span><span title="LineNr "class="LineNr">2</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> configs &#61; </span><span title="luaFunc "class="luaFunc">require</span><span title="Normal "class="Normal"> </span><span title="luaString "class="luaString">&#39;nvim_lsp/configs&#39;
</span><span title="LineNr "class="LineNr">3</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> util &#61; </span><span title="luaFunc "class="luaFunc">require</span><span title="Normal "class="Normal"> </span><span title="luaString "class="luaString">&#39;nvim_lsp/util&#39;
</span><span title="LineNr "class="LineNr">4</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> inspect &#61; vim.inspect
</span><span title="LineNr "class="LineNr">5</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> uv &#61; vim.loop
</span><span title="LineNr "class="LineNr">6</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> fn &#61; vim.fn
</span><span title="LineNr "class="LineNr">7</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> tbl_flatten &#61; vim.tbl_flatten
</span><span title="LineNr "class="LineNr">8</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">9</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> template(s, params)
</span><span title="LineNr "class="LineNr">10</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> (s:gsub(</span><span title="luaString "class="luaString">&quot;{{([^{}]+)}}&quot;</span><span title="Normal "class="Normal">, params))
</span><span title="LineNr "class="LineNr">11</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">12</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">13</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> map_list(t, func)
</span><span title="LineNr "class="LineNr">14</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> res &#61; </span><span title="luaTable "class="luaTable">{}
</span><span title="LineNr "class="LineNr">15</span>  <span title="Normal "class="Normal">  </span><span title="luaRepeat "class="luaRepeat">for</span><span title="Normal "class="Normal"> i, v </span><span title="luaIn "class="luaIn">in</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">ipairs</span><span title="Normal "class="Normal">(t) </span><span title="luaStatement "class="luaStatement">do
</span><span title="LineNr "class="LineNr">16</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> x &#61; func(v, i)
</span><span title="LineNr "class="LineNr">17</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> x ~&#61; </span><span title="luaConstant "class="luaConstant">nil</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">18</span>  <span title="Normal "class="Normal">      </span><span title="luaFunc "class="luaFunc">table.insert</span><span title="Normal "class="Normal">(res, x)
</span><span title="LineNr "class="LineNr">19</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">20</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">end
</span><span title="LineNr "class="LineNr">21</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> res
</span><span title="LineNr "class="LineNr">22</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">23</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">24</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> indent(n, s)
</span><span title="LineNr "class="LineNr">25</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> prefix
</span><span title="LineNr "class="LineNr">26</span>  <span title="Normal "class="Normal">  </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">type</span><span title="Normal "class="Normal">(n) &#61;&#61; </span><span title="luaString "class="luaString">&#39;number&#39;</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">27</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> n &lt;&#61; </span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then</span><span title="Normal "class="Normal"> </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> s </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">28</span>  <span title="Normal "class="Normal">    prefix &#61; </span><span title="luaFunc "class="luaFunc">string.rep</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot; &quot;</span><span title="Normal "class="Normal">, n)
</span><span title="LineNr "class="LineNr">29</span>  <span title="Normal "class="Normal">  </span><span title="luaElse "class="luaElse">else
</span><span title="LineNr "class="LineNr">30</span>  <span title="Normal "class="Normal">    </span><span title="luaFunc "class="luaFunc">assert</span><span title="Normal "class="Normal">(</span><span title="luaFunc "class="luaFunc">type</span><span title="Normal "class="Normal">(n) &#61;&#61; </span><span title="luaString "class="luaString">&#39;string&#39;</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;n must be number or string&#39;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">31</span>  <span title="Normal "class="Normal">    prefix &#61; n
</span><span title="LineNr "class="LineNr">32</span>  <span title="Normal "class="Normal">  </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">33</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> lines &#61; vim.split(s, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaConstant "class="luaConstant">true</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">34</span>  <span title="Normal "class="Normal">  </span><span title="luaRepeat "class="luaRepeat">for</span><span title="Normal "class="Normal"> i, line </span><span title="luaIn "class="luaIn">in</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">ipairs</span><span title="Normal "class="Normal">(lines) </span><span title="luaStatement "class="luaStatement">do
</span><span title="LineNr "class="LineNr">35</span>  <span title="Normal "class="Normal">    lines[i] &#61; prefix..line
</span><span title="LineNr "class="LineNr">36</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">end
</span><span title="LineNr "class="LineNr">37</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">table.concat</span><span title="Normal "class="Normal">(lines, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">38</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">39</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">40</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> make_parts(fns)
</span><span title="LineNr "class="LineNr">41</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> tbl_flatten(map_list(fns, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(v)
</span><span title="LineNr "class="LineNr">42</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">type</span><span title="Normal "class="Normal">(v) &#61;&#61; </span><span title="luaString "class="luaString">&#39;function&#39;</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">43</span>  <span title="Normal "class="Normal">      v &#61; v()
</span><span title="LineNr "class="LineNr">44</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">45</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">v</span><span title="luaTable "class="luaTable">}
</span><span title="LineNr "class="LineNr">46</span>  <span title="Normal "class="Normal">  </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">))
</span><span title="LineNr "class="LineNr">47</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">48</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">49</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> make_section(indentlvl, sep, parts)
</span><span title="LineNr "class="LineNr">50</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> indent(indentlvl, </span><span title="luaFunc "class="luaFunc">table.concat</span><span title="Normal "class="Normal">(make_parts(parts), sep))
</span><span title="LineNr "class="LineNr">51</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">52</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">53</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> readfile(path)
</span><span title="LineNr "class="LineNr">54</span>  <span title="Normal "class="Normal">  </span><span title="luaFunc "class="luaFunc">assert</span><span title="Normal "class="Normal">(util.path.is_file(path))
</span><span title="LineNr "class="LineNr">55</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">io.open</span><span title="Normal "class="Normal">(path):read(</span><span title="luaString "class="luaString">&quot;*a&quot;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">56</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">57</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">58</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> sorted_map_table(t, func)
</span><span title="LineNr "class="LineNr">59</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> keys &#61; vim.tbl_keys(t)
</span><span title="LineNr "class="LineNr">60</span>  <span title="Normal "class="Normal">  </span><span title="luaFunc "class="luaFunc">table.sort</span><span title="Normal "class="Normal">(keys)
</span><span title="LineNr "class="LineNr">61</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> map_list(keys, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(k)
</span><span title="LineNr "class="LineNr">62</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> func(k, t[k])
</span><span title="LineNr "class="LineNr">63</span>  <span title="Normal "class="Normal">  </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">64</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">65</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">66</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> lsp_section_template &#61; </span><span title="luaString "class="luaString">[[
</span><span title="LineNr "class="LineNr">67</span>  <span title="luaString2 "class="luaString2">## {{template_name}}
</span><span title="LineNr "class="LineNr">68</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">69</span>  <span title="luaString2 "class="luaString2">{{preamble}}
</span><span title="LineNr "class="LineNr">70</span>  <span title="luaString2 "class="luaString2">```lua
</span><span title="LineNr "class="LineNr">71</span>  <span title="luaString2 "class="luaString2">require&#39;nvim_lsp&#39;.{{template_name}}.setup{}
</span><span title="LineNr "class="LineNr">72</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">73</span>  <span title="luaString2 "class="luaString2">{{body}}
</span><span title="LineNr "class="LineNr">74</span>  <span title="luaString2 "class="luaString2">```
</span><span title="LineNr "class="LineNr">75</span>  <span title="luaString "class="luaString">]]
</span><span title="LineNr "class="LineNr">76</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">77</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> require_all_configs()
</span><span title="LineNr "class="LineNr">78</span>  <span title="Normal "class="Normal">  </span><span title="luaComment "class="luaComment">-- Configs are lazy-loaded, tickle them to populate the `configs` singleton.
</span><span title="LineNr "class="LineNr">79</span>  <span title="Normal "class="Normal">  </span><span title="luaRepeat "class="luaRepeat">for</span><span title="Normal "class="Normal"> _,v </span><span title="luaIn "class="luaIn">in</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">ipairs</span><span title="Normal "class="Normal">(vim.fn.glob(</span><span title="luaString "class="luaString">&#39;lua/nvim_lsp/*.lua&#39;</span><span title="Normal "class="Normal">, </span><span title="luaNumber "class="luaNumber">1</span><span title="Normal "class="Normal">, </span><span title="luaNumber "class="luaNumber">1</span><span title="Normal "class="Normal">)) </span><span title="luaStatement "class="luaStatement">do
</span><span title="LineNr "class="LineNr">80</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> module_name &#61; v:gsub(</span><span title="luaString "class="luaString">&#39;.*/&#39;</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">):gsub(</span><span title="luaString "class="luaString">&#39;%.lua$&#39;</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">81</span>  <span title="Normal "class="Normal">    </span><span title="luaFunc "class="luaFunc">require</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&#39;nvim_lsp/&#39;</span><span title="Normal "class="Normal">..module_name)
</span><span title="LineNr "class="LineNr">82</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">end
</span><span title="LineNr "class="LineNr">83</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">84</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">85</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> make_lsp_sections()
</span><span title="LineNr "class="LineNr">86</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, sorted_map_table(configs, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(template_name, template_object)
</span><span title="LineNr "class="LineNr">87</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> template_def &#61; template_object.document_config
</span><span title="LineNr "class="LineNr">88</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> docs &#61; template_def.docs
</span><span title="LineNr "class="LineNr">89</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">90</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> params &#61; </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">91</span>  <span title="Normal "class="Normal">      template_name &#61; template_name;
</span><span title="LineNr "class="LineNr">92</span>  <span title="Normal "class="Normal">      preamble &#61; </span><span title="luaString "class="luaString">&quot;&quot;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">93</span>  <span title="Normal "class="Normal">      body &#61; </span><span title="luaString "class="luaString">&quot;&quot;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">94</span>  <span title="Normal "class="Normal">    </span><span title="luaTable "class="luaTable">}
</span><span title="LineNr "class="LineNr">95</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">96</span>  <span title="Normal "class="Normal">    params.body &#61; make_section(</span><span title="luaNumber "class="luaNumber">2</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">97</span>  <span title="Normal "class="Normal">      </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">98</span>  <span title="Normal "class="Normal">        </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> template_def.commands </span><span title="luaCond "class="luaCond">then</span><span title="Normal "class="Normal"> </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">99</span>  <span title="Normal "class="Normal">        </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">100</span>  <span title="Normal "class="Normal">          </span><span title="luaString "class="luaString">&quot;Commands:&quot;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">101</span>  <span title="Normal "class="Normal">          sorted_map_table(template_def.commands, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(name, def)
</span><span title="LineNr "class="LineNr">102</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> def.description </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">103</span>  <span title="Normal "class="Normal">              </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;- %s: %s&quot;</span><span title="Normal "class="Normal">, name, def.description)
</span><span title="LineNr "class="LineNr">104</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">105</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;- %s&quot;</span><span title="Normal "class="Normal">, name)
</span><span title="LineNr "class="LineNr">106</span>  <span title="Normal "class="Normal">          </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">107</span>  <span title="Normal "class="Normal">        </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">108</span>  <span title="Normal "class="Normal">      </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">109</span>  <span title="Normal "class="Normal">      </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">110</span>  <span title="Normal "class="Normal">        </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> template_def.default_config </span><span title="luaCond "class="luaCond">then</span><span title="Normal "class="Normal"> </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">111</span>  <span title="Normal "class="Normal">        </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">112</span>  <span title="Normal "class="Normal">          </span><span title="luaString "class="luaString">&quot;Default Values:&quot;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">113</span>  <span title="Normal "class="Normal">          sorted_map_table(template_def.default_config, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(k, v)
</span><span title="LineNr "class="LineNr">114</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> description &#61; ((docs </span><span title="luaOperator "class="luaOperator">or</span><span title="Normal "class="Normal"> </span><span title="luaTable "class="luaTable">{}</span><span title="Normal "class="Normal">).default_config </span><span title="luaOperator "class="luaOperator">or</span><span title="Normal "class="Normal"> </span><span title="luaTable "class="luaTable">{}</span><span title="Normal "class="Normal">)[k]
</span><span title="LineNr "class="LineNr">115</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> description </span><span title="luaOperator "class="luaOperator">and</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">type</span><span title="Normal "class="Normal">(description) ~&#61; </span><span title="luaString "class="luaString">&#39;string&#39;</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">116</span>  <span title="Normal "class="Normal">              description &#61; inspect(description)
</span><span title="LineNr "class="LineNr">117</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">118</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> indent(</span><span title="luaNumber "class="luaNumber">2</span><span title="Normal "class="Normal">, </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;%s &#61; %s&quot;</span><span title="Normal "class="Normal">, k, description </span><span title="luaOperator "class="luaOperator">or</span><span title="Normal "class="Normal"> inspect(v)))
</span><span title="LineNr "class="LineNr">119</span>  <span title="Normal "class="Normal">          </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">120</span>  <span title="Normal "class="Normal">        </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">121</span>  <span title="Normal "class="Normal">      </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">122</span>  <span title="Normal "class="Normal">    </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">123</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">124</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> docs </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">125</span>  <span title="Normal "class="Normal">      </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> tempdir &#61; </span><span title="luaFunc "class="luaFunc">os.getenv</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;DOCGEN_TEMPDIR&quot;</span><span title="Normal "class="Normal">) </span><span title="luaOperator "class="luaOperator">or</span><span title="Normal "class="Normal"> uv.fs_mkdtemp(</span><span title="luaString "class="luaString">&quot;/tmp/nvim-lsp.XXXXXX&quot;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">126</span>  <span title="Normal "class="Normal">      </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> preamble_parts &#61; make_parts </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">127</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">128</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> docs.description </span><span title="luaOperator "class="luaOperator">and</span><span title="Normal "class="Normal"> #docs.description &gt; </span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">129</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> docs.description
</span><span title="LineNr "class="LineNr">130</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">131</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">132</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">133</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> template_object.install </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">134</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;Can be installed in Nvim with `:LspInstall %s`&quot;</span><span title="Normal "class="Normal">, template_name)
</span><span title="LineNr "class="LineNr">135</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">136</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">137</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">138</span>  <span title="Normal "class="Normal">          </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> package_json_name &#61; util.path.join(tempdir, template_name..</span><span title="luaString "class="luaString">&#39;.package.json&#39;</span><span title="Normal "class="Normal">);
</span><span title="LineNr "class="LineNr">139</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> docs.package_json </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">140</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> util.path.is_file(package_json_name) </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">141</span>  <span title="Normal "class="Normal">              </span><span title="luaFunc "class="luaFunc">os.execute</span><span title="Normal "class="Normal">(</span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;curl -L -o %q %q&quot;</span><span title="Normal "class="Normal">, package_json_name, docs.package_json))
</span><span title="LineNr "class="LineNr">142</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">143</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> util.path.is_file(package_json_name) </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">144</span>  <span title="Normal "class="Normal">              </span><span title="luaFunc "class="luaFunc">print</span><span title="Normal "class="Normal">(</span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;Failed to download package.json for %q at %q&quot;</span><span title="Normal "class="Normal">, template_name, docs.package_json))
</span><span title="LineNr "class="LineNr">145</span>  <span title="Normal "class="Normal">              </span><span title="luaFunc "class="luaFunc">os.exit</span><span title="Normal "class="Normal">(</span><span title="luaNumber "class="luaNumber">1</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">146</span>  <span title="Normal "class="Normal">              </span><span title="luaStatement "class="luaStatement">return
</span><span title="LineNr "class="LineNr">147</span>  <span title="Normal "class="Normal">            </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">148</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> data &#61; fn.json_decode(readfile(package_json_name))
</span><span title="LineNr "class="LineNr">149</span>  <span title="Normal "class="Normal">            </span><span title="luaComment "class="luaComment">-- The entire autogenerated section.
</span><span title="LineNr "class="LineNr">150</span>  <span title="Normal "class="Normal">            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">151</span>  <span title="Normal "class="Normal">              </span><span title="luaComment "class="luaComment">-- The default settings section
</span><span title="LineNr "class="LineNr">152</span>  <span title="Normal "class="Normal">              </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">153</span>  <span title="Normal "class="Normal">                </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> default_settings &#61; (data.contributes </span><span title="luaOperator "class="luaOperator">or</span><span title="Normal "class="Normal"> </span><span title="luaTable "class="luaTable">{}</span><span title="Normal "class="Normal">).configuration
</span><span title="LineNr "class="LineNr">154</span>  <span title="Normal "class="Normal">                </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> default_settings.properties </span><span title="luaCond "class="luaCond">then</span><span title="Normal "class="Normal"> </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">155</span>  <span title="Normal "class="Normal">                </span><span title="luaComment "class="luaComment">-- The outer section.
</span><span title="LineNr "class="LineNr">156</span>  <span title="Normal "class="Normal">                </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">157</span>  <span title="Normal "class="Normal">                  </span><span title="luaString "class="luaString">&#39;This server accepts configuration via the `settings` key.&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">158</span>  <span title="Normal "class="Normal">                  </span><span title="luaString "class="luaString">&#39;&lt;details&gt;&lt;summary&gt;Available settings:&lt;/summary&gt;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">159</span>  <span title="Normal "class="Normal">                  </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">160</span>  <span title="Normal "class="Normal">                  </span><span title="luaComment "class="luaComment">-- The list of properties.
</span><span title="LineNr "class="LineNr">161</span>  <span title="Normal "class="Normal">                  make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, sorted_map_table(default_settings.properties, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(k, v)
</span><span title="LineNr "class="LineNr">162</span>  <span title="Normal "class="Normal">                    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> tick(s) </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;`%s`&quot;</span><span title="Normal "class="Normal">, s) </span><span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">163</span>  <span title="Normal "class="Normal">                    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> bold(s) </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">string.format</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;**%s**&quot;</span><span title="Normal "class="Normal">, s) </span><span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">164</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">165</span>  <span title="Normal "class="Normal">                    </span><span title="luaComment "class="luaComment">-- https://github.github.com/gfm/#backslash-escapes
</span><span title="LineNr "class="LineNr">166</span>  <span title="Normal "class="Normal">                    </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> excape_markdown_punctuations(str)
</span><span title="LineNr "class="LineNr">167</span>  <span title="Normal "class="Normal">                      </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> pattern &#61; </span><span title="luaString "class="luaString">&quot;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">(</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">*</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">.</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|?</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|!</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\&quot;\\</span><span title="luaString "class="luaString">|#</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">$</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|%</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|&#39;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|(</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|)</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|,</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|-</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">/</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|:</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|&lt;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|&#61;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|&gt;</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|@</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">[</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\\\\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">]</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">^</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|_</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|`</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|{</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\\\</span><span title="luaString "class="luaString">|</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">|}</span><span title="luaSpecial "class="luaSpecial">\\</span><span title="luaString "class="luaString">)&quot;
</span><span title="LineNr "class="LineNr">168</span>  <span title="Normal "class="Normal">                      </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> fn.substitute(str, pattern, </span><span title="luaString "class="luaString">&quot;</span><span title="luaSpecial "class="luaSpecial">\\\\\\</span><span title="luaString "class="luaString">0&quot;</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&quot;g&quot;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">169</span>  <span title="Normal "class="Normal">                    </span><span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">170</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">171</span>  <span title="Normal "class="Normal">                    </span><span title="luaComment "class="luaComment">-- local function pre(s) return string.format(&quot;&lt;pre&gt;%s&lt;/pre&gt;&quot;, s) end
</span><span title="LineNr "class="LineNr">172</span>  <span title="Normal "class="Normal">                    </span><span title="luaComment "class="luaComment">-- local function code(s) return string.format(&quot;&lt;code&gt;%s&lt;/code&gt;&quot;, s) end
</span><span title="LineNr "class="LineNr">173</span>  <span title="Normal "class="Normal">                    </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">174</span>  <span title="Normal "class="Normal">                      </span><span title="luaString "class="luaString">&quot;- &quot;</span><span title="Normal "class="Normal">..make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;: &#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">175</span>  <span title="Normal "class="Normal">                        bold(tick(k));
</span><span title="LineNr "class="LineNr">176</span>  <span title="Normal "class="Normal">                        </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">()
</span><span title="LineNr "class="LineNr">177</span>  <span title="Normal "class="Normal">                          </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> v.enum </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">178</span>  <span title="Normal "class="Normal">                            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> tick(</span><span title="luaString "class="luaString">&quot;enum &quot;</span><span title="Normal "class="Normal">..inspect(v.enum))
</span><span title="LineNr "class="LineNr">179</span>  <span title="Normal "class="Normal">                          </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">180</span>  <span title="Normal "class="Normal">                          </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> v.</span><span title="luaFunc "class="luaFunc">type</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">181</span>  <span title="Normal "class="Normal">                            </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> tick(</span><span title="luaFunc "class="luaFunc">table.concat</span><span title="Normal "class="Normal">(tbl_flatten</span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">v.</span><span title="luaFunc "class="luaFunc">type</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;|&#39;</span><span title="Normal "class="Normal">))
</span><span title="LineNr "class="LineNr">182</span>  <span title="Normal "class="Normal">                          </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">183</span>  <span title="Normal "class="Normal">                        </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">184</span>  <span title="Normal "class="Normal">                      </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">);
</span><span title="LineNr "class="LineNr">185</span>  <span title="Normal "class="Normal">                      </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">186</span>  <span title="Normal "class="Normal">                      make_section(</span><span title="luaNumber "class="luaNumber">2</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">187</span>  <span title="Normal "class="Normal">                        </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">v.default </span><span title="luaOperator "class="luaOperator">and</span><span title="Normal "class="Normal"> </span><span title="luaString "class="luaString">&quot;Default: &quot;</span><span title="Normal "class="Normal">..tick(inspect(v.default, </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">newline&#61;</span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">;indent&#61;</span><span title="luaString "class="luaString">&#39;&#39;</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">))</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">188</span>  <span title="Normal "class="Normal">                        </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">v.items </span><span title="luaOperator "class="luaOperator">and</span><span title="Normal "class="Normal"> </span><span title="luaString "class="luaString">&quot;Array items: &quot;</span><span title="Normal "class="Normal">..tick(inspect(v.items, </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">newline&#61;</span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">;indent&#61;</span><span title="luaString "class="luaString">&#39;&#39;</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">))</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">189</span>  <span title="Normal "class="Normal">                        </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">excape_markdown_punctuations(v.description)</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">190</span>  <span title="Normal "class="Normal">                      </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">);
</span><span title="LineNr "class="LineNr">191</span>  <span title="Normal "class="Normal">                    </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">192</span>  <span title="Normal "class="Normal">                  </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">));
</span><span title="LineNr "class="LineNr">193</span>  <span title="Normal "class="Normal">                  </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">194</span>  <span title="Normal "class="Normal">                  </span><span title="luaString "class="luaString">&#39;&lt;/details&gt;&#39;</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">195</span>  <span title="Normal "class="Normal">                </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">196</span>  <span title="Normal "class="Normal">              </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">197</span>  <span title="Normal "class="Normal">            </span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">198</span>  <span title="Normal "class="Normal">          </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">199</span>  <span title="Normal "class="Normal">        </span><span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">200</span>  <span title="Normal "class="Normal">      </span><span title="luaTable "class="luaTable">}
</span><span title="LineNr "class="LineNr">201</span>  <span title="Normal "class="Normal">      </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> </span><span title="luaOperator "class="luaOperator">not</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">os.getenv</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;DOCGEN_TEMPDIR&quot;</span><span title="Normal "class="Normal">) </span><span title="luaCond "class="luaCond">then
</span><span title="LineNr "class="LineNr">202</span>  <span title="Normal "class="Normal">        </span><span title="luaFunc "class="luaFunc">os.execute</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;rm -rf &quot;</span><span title="Normal "class="Normal">..tempdir)
</span><span title="LineNr "class="LineNr">203</span>  <span title="Normal "class="Normal">      </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">204</span>  <span title="Normal "class="Normal">      </span><span title="luaComment "class="luaComment">-- Insert a newline after the preamble if it exists.
</span><span title="LineNr "class="LineNr">205</span>  <span title="Normal "class="Normal">      </span><span title="luaCond "class="luaCond">if</span><span title="Normal "class="Normal"> #preamble_parts &gt; </span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal"> </span><span title="luaCond "class="luaCond">then</span><span title="Normal "class="Normal"> </span><span title="luaFunc "class="luaFunc">table.insert</span><span title="Normal "class="Normal">(preamble_parts, </span><span title="luaString "class="luaString">&#39;&#39;</span><span title="Normal "class="Normal">) </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">206</span>  <span title="Normal "class="Normal">      params.preamble &#61; </span><span title="luaFunc "class="luaFunc">table.concat</span><span title="Normal "class="Normal">(preamble_parts, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">207</span>  <span title="Normal "class="Normal">    </span><span title="luaCond "class="luaCond">end
</span><span title="LineNr "class="LineNr">208</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">209</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> template(lsp_section_template, params)
</span><span title="LineNr "class="LineNr">210</span>  <span title="Normal "class="Normal">  </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">))
</span><span title="LineNr "class="LineNr">211</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">212</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">213</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> make_implemented_servers_list()
</span><span title="LineNr "class="LineNr">214</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> make_section(</span><span title="luaNumber "class="luaNumber">0</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&#39;</span><span title="luaSpecial "class="luaSpecial">\n</span><span title="luaString "class="luaString">&#39;</span><span title="Normal "class="Normal">, sorted_map_table(configs, </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal">(k)
</span><span title="LineNr "class="LineNr">215</span>  <span title="Normal "class="Normal">    </span><span title="luaStatement "class="luaStatement">return</span><span title="Normal "class="Normal"> template(</span><span title="luaString "class="luaString">&quot;- [{{server}}](#{{server}})&quot;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">server&#61;k</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">216</span>  <span title="Normal "class="Normal">  </span><span title="luaFunction "class="luaFunction">end</span><span title="Normal "class="Normal">))
</span><span title="LineNr "class="LineNr">217</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">218</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">219</span>  <span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> </span><span title="luaFunction "class="luaFunction">function</span><span title="Normal "class="Normal"> generate_readme(template_file, params)
</span><span title="LineNr "class="LineNr">220</span>  <span title="Normal "class="Normal">  vim.validate </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">221</span>  <span title="Normal "class="Normal">    lsp_server_details &#61; </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">params.lsp_server_details, </span><span title="luaString "class="luaString">&#39;s&#39;</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">222</span>  <span title="Normal "class="Normal">    implemented_servers_list &#61; </span><span title="luaTable "class="luaTable">{</span><span title="Normal "class="Normal">params.implemented_servers_list, </span><span title="luaString "class="luaString">&#39;s&#39;</span><span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">;
</span><span title="LineNr "class="LineNr">223</span>  <span title="Normal "class="Normal">  </span><span title="luaTable "class="luaTable">}
</span><span title="LineNr "class="LineNr">224</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> input_template &#61; readfile(template_file)
</span><span title="LineNr "class="LineNr">225</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> readme_data &#61; template(input_template, params)
</span><span title="LineNr "class="LineNr">226</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">227</span>  <span title="Normal "class="Normal">  </span><span title="luaStatement "class="luaStatement">local</span><span title="Normal "class="Normal"> writer &#61; </span><span title="luaFunc "class="luaFunc">io.open</span><span title="Normal "class="Normal">(</span><span title="luaString "class="luaString">&quot;README.md&quot;</span><span title="Normal "class="Normal">, </span><span title="luaString "class="luaString">&quot;w&quot;</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">228</span>  <span title="Normal "class="Normal">  writer:write(readme_data)
</span><span title="LineNr "class="LineNr">229</span>  <span title="Normal "class="Normal">  writer:close()
</span><span title="LineNr "class="LineNr">230</span>  <span title="luaFunction "class="luaFunction">end
</span><span title="LineNr "class="LineNr">231</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">232</span>  <span title="Normal "class="Normal">require_all_configs()
</span><span title="LineNr "class="LineNr">233</span>  <span title="Normal "class="Normal">generate_readme(</span><span title="luaString "class="luaString">&quot;scripts/README_template.md&quot;</span><span title="Normal "class="Normal">, </span><span title="luaTable "class="luaTable">{
</span><span title="LineNr "class="LineNr">234</span>  <span title="Normal "class="Normal">  implemented_servers_list &#61; make_implemented_servers_list();
</span><span title="LineNr "class="LineNr">235</span>  <span title="Normal "class="Normal">  lsp_server_details &#61; make_lsp_sections();
</span><span title="LineNr "class="LineNr">236</span>  <span title="luaTable "class="luaTable">}</span><span title="Normal "class="Normal">)
</span><span title="LineNr "class="LineNr">237</span>  <span title="Normal "class="Normal">
</span><span title="LineNr "class="LineNr">238</span>  <span title="luaComment "class="luaComment">-- vim:et ts&#61;2 sw&#61;2
</span><span title="LineNr "class="LineNr last-LineNr">239</span>  <span title="Normal "class="Normal"></span>